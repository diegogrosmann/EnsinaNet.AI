{% extends "admin/base_site.html" %}
{% load i18n admin_urls static admin_list %}

{% block content %}
<div id="content-main">

    <div class="results">
        <table id="result_list">
            <thead>
                <tr>
                    <th>Nome do Modelo</th>
                    <th>Status</th>
                    <th>Data de Criação</th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody>
                {% for model in models %}
                <tr>
                    <td>{{ model.name }}</td>
                    <td>{{ model.status }}</td>
                    <td>{{ model.created_at|date:"d/m/Y H:i" }}</td>
                    <td>
                        <button class="deleteBtn" data-model-name="{{ model.name }}"
                                onclick="deleteModel('{{ model.name }}')">
                            Excluir
                        </button>
                    </td>
                </tr>
                {% empty %}
                <tr><td colspan="4">Nenhum modelo encontrado.</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<script>
function deleteModel(modelName) {
    if (!confirm('Tem certeza que deseja excluir este modelo?')) return;
    
    fetch(`./delete/${modelName}/`, {
        method: 'POST',
        headers: {
            'X-CSRFToken': '{{ csrf_token }}',
            'Content-Type': 'application/json'
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            location.reload();
        } else {
            alert(data.error || 'Erro ao excluir modelo');
        }
    })
    .catch(error => {
        alert('Erro ao excluir modelo');
        console.error('Erro:', error);
    });
}
</script>
{% endblock %}
