{% extends 'base.html' %}

{% block content %}
<div class="container py-4">
  <!-- Card Principal usando componentes nativos do Bootswatch -->
  <div class="card border-primary mb-3">
    <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
      <h4 class="card-title mb-0">
        <i class="bi bi-gear me-2"></i>
        Configurações para o Token "{{ token.name }}"
        <button class="btn btn-sm btn-outline-light ms-2" data-bs-toggle="modal" data-bs-target="#editTokenNameModal" aria-label="Editar nome do token">
          <i class="bi bi-pencil-square"></i>
        </button>
      </h4>
      <a href="{% url 'accounts:tokens_manage' %}" class="btn btn-outline-light" aria-label="Voltar">
        <i class="bi bi-arrow-left"></i> Voltar
      </a>
    </div>

    <div class="card-body">
      <!-- Cards de Navegação usando componentes do Bootswatch -->
      <div class="row row-cols-1 row-cols-md-3 g-4">
        
        <!-- Card de Configurações de Prompt -->
        <div class="col">
          <div class="card h-100 border-success">
            <div class="card-header bg-success text-white">
              <h5 class="card-title mb-0">
                <i class="bi bi-chat-left-text-fill me-2"></i>
                Configurações de Prompt
              </h5>
            </div>
            <div class="card-body">
              <p class="card-text">Configure instruções base e prompts personalizados.</p>
            </div>
            <div class="card-footer bg-transparent text-center">
              <a href="{% url 'ai_config:token_prompt_config' token.id %}" class="btn btn-success w-100">
                <i class="bi bi-arrow-right"></i> Acessar
              </a>
            </div>
          </div>
        </div>
        
        <!-- Card de Vinculação de IAs -->
        <div class="col">
          <div class="card h-100 border-primary">
            <div class="card-header bg-primary text-white">
              <h5 class="card-title mb-0">
                <i class="bi bi-robot me-2"></i>
                Vinculação de IAs
              </h5>
            </div>
            <div class="card-body">
              <p class="card-text">Selecione quais IAs estarão disponíveis para este token.</p>
            </div>
            <div class="card-footer bg-transparent text-center">
              <a href="{% url 'ai_config:token_ai_link' token.id %}" class="btn btn-primary w-100">
                <i class="bi bi-arrow-right"></i> Gerenciar IAs
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal para editar nome do token -->
<div class="modal fade" id="editTokenNameModal" tabindex="-1" aria-labelledby="editTokenNameModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title" id="editTokenNameModalLabel">
          <i class="bi bi-pencil me-2"></i>
          Editar Nome do Token
        </h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form method="POST" action="{% url 'accounts:token_edit_name' token.id %}">
        {% csrf_token %}
        <div class="modal-body">
          <div class="form-group mb-3">
            <label for="token_name" class="form-label">Novo nome</label>
            <input type="text" class="form-control" id="token_name" name="name" value="{{ token.name }}" required>
            <small class="form-text text-muted">Use um nome descritivo para identificar facilmente este token.</small>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
            <i class="bi bi-x-lg me-1"></i>Cancelar
          </button>
          <button type="submit" class="btn btn-primary">
            <i class="bi bi-check-lg me-1"></i>Salvar
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
